<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="renderer" content="webkit|ie-comp|ie-stand">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
  <meta http-equiv="Cache-Control" content="no-siteapp"/>
  <title>301医院门诊管理系统 药方</title>
  <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../static/h-ui/css/H-ui.min.css">
  <link rel="stylesheet" href="../static/h-ui.admin/css/H-ui.admin.css">
  <link rel="stylesheet" href="../static/Hui-iconfont/1.0.8/iconfont.css">
  <link rel="stylesheet" href="../static/h-ui.admin/skin/default/skin.css" id="skin">
  <link rel="stylesheet" href="../static/h-ui.admin/css/style.css">
</head>
<body>
<table class="table table-border table-bordered table-bg">
  <thead>
  <tr class="text-c">
    <th width="40">No.</th>
    <th width="100">药品类别</th>
    <th width="100">药品名字</th>
    <th width="90">药品价格</th>
    <th width="150">数量</th>
  </tr>
  </thead>
  <tfoot>
  <tr class="text-c">
    <th width="40">No.</th>
    <th width="100">药品类别</th>
    <th width="100">药品名字</th>
    <th width="90">药品价格</th>
    <th width="150">数量</th>
  </tr>
  </tfoot>
  <tbody>

  </tbody>
</table>

<div align="center">
  <button onClick="layer_close();" class="btn btn-primary size-L radius" type="button"> 确定&nbsp;</button>
</div>

<script src="../js/jquery-3.3.1.min.js"></script>
<script src="../js/jquery.dataTables.min.js"></script>
<script src="../static/h-ui/js/H-ui.min.js"></script>
<script src="../static/h-ui.admin/js/H-ui.admin.js"></script>
<script src="../static/WdatePicker/WdatePicker.js"></script>
<script src="../static/layer/2.4/layer.js"></script>
<script src="../static/layer/laypage.js"></script>
<script src="../js/hospital.js"></script>
<script>
  $(window).on('load', () => {
    var prid = localStorage.getItem("prid")
    localStorage.removeItem("prid")

    // 查看某张药方项
    $.ajax({
      url: HOST_URL + "doctorvisdrug/" + prid,
      type: "GET",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      headers: createAuthorizationTokenHeader(),
      success: function (data, intextStatus, injqXHR) {
        console.log(data)

        var text = ``
        $.each(data, (i, item) => {
          i += 0
          text += `
          <tr class="text-c">
            <td>${i}</td>
            <td>${data.drug.drugtype.dyname}</td>
            <td>${data.drug.drname}</td>
            <td>${data.drug.drprice}</td>
            <td>${data.drnum}</td>
          </tr>
          `
        })
        $("tbody").append(text)

        $('.table-sort').DataTable({
          language: {
            url: "../js/zh_CN.txt"
          }
        })
      },
      error: function (jqXHR, textStatus, errorThrown) {
        console.log("Spring exception:", jqXHR.responseJSON.exception)
        layer.alert("系统出现错误，请联系管理员");
      }
    })

  })
</script>
</body>
</html>